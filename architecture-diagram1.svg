<?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="0 0 1000 600" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1000" height="600" fill="#f7f9fb" />
  
  <!-- Title -->
  <text x="500" y="40" font-family="Arial" font-size="24" font-weight="bold" text-anchor="middle" fill="#333">Central Threat Intelligence V4: Inoculation Engine Architecture</text>
  
  <!-- Data Sources Section -->
  <rect x="50" y="80" width="180" height="160" rx="10" ry="10" fill="#e6f2ff" stroke="#0066cc" stroke-width="2" />
  <text x="140" y="100" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle">Data Sources</text>
  
  <rect x="70" y="110" width="140" height="30" rx="5" ry="5" fill="#ffffff" stroke="#0066cc" stroke-width="1" />
  <text x="140" y="130" font-family="Arial" font-size="12" text-anchor="middle">STIX/TAXII Feeds</text>
  
  <rect x="70" y="150" width="140" height="30" rx="5" ry="5" fill="#ffffff" stroke="#0066cc" stroke-width="1" />
  <text x="140" y="170" font-family="Arial" font-size="12" text-anchor="middle">Security APIs</text>
  
  <rect x="70" y="190" width="140" height="30" rx="5" ry="5" fill="#ffffff" stroke="#0066cc" stroke-width="1" />
  <text x="140" y="210" font-family="Arial" font-size="12" text-anchor="middle">Manual Input</text>
  
  <!-- Core System -->
  <rect x="290" y="80" width="420" height="440" rx="10" ry="10" fill="#f0f7f0" stroke="#2e8b57" stroke-width="2" />
  <text x="500" y="100" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle">CTI-V4 Inoculation Engine</text>
  
  <!-- Unified Indicator Store -->
  <rect x="310" y="120" width="380" height="60" rx="5" ry="5" fill="#ffffff" stroke="#2e8b57" stroke-width="1" />
  <text x="500" y="140" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Unified Indicator Store</text>
  <text x="500" y="160" font-family="Arial" font-size="11" text-anchor="middle">CTI_ThreatIntelIndicator_CL, CTI_DistributionTargets_CL, CTI_EffectivenessMetrics_CL</text>
  
  <!-- Risk Assessment Engine -->
  <rect x="310" y="190" width="180" height="140" rx="5" ry="5" fill="#ffffff" stroke="#2e8b57" stroke-width="1" />
  <text x="400" y="210" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Risk Assessment Engine</text>
  
  <rect x="320" y="220" width="160" height="25" rx="3" ry="3" fill="#f0f7f0" stroke="#2e8b57" stroke-width="1" />
  <text x="400" y="237" font-family="Arial" font-size="11" text-anchor="middle">Reputation Services</text>
  
  <rect x="320" y="250" width="160" height="25" rx="3" ry="3" fill="#f0f7f0" stroke="#2e8b57" stroke-width="1" />
  <text x="400" y="267" font-family="Arial" font-size="11" text-anchor="middle">Internal Telemetry</text>
  
  <rect x="320" y="280" width="160" height="25" rx="3" ry="3" fill="#f0f7f0" stroke="#2e8b57" stroke-width="1" />
  <text x="400" y="297" font-family="Arial" font-size="11" text-anchor="middle">Contextual Relevance</text>
  
  <rect x="320" y="310" width="160" height="25" rx="3" ry="3" fill="#f0f7f0" stroke="#2e8b57" stroke-width="1" />
  <text x="400" y="327" font-family="Arial" font-size="11" text-anchor="middle">Composite Scoring</text>
  
  <!-- Inoculation Decision Engine -->
  <rect x="510" y="190" width="180" height="140" rx="5" ry="5" fill="#ffffff" stroke="#2e8b57" stroke-width="1" />
  <text x="600" y="210" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Inoculation Engine</text>
  
  <rect x="520" y="220" width="160" height="25" rx="3" ry="3" fill="#e6ffe6" stroke="#2e8b57" stroke-width="1" />
  <text x="600" y="237" font-family="Arial" font-size="11" text-anchor="middle">Tier 1: Auto-distribute</text>
  
  <rect x="520" y="250" width="160" height="25" rx="3" ry="3" fill="#ffffe6" stroke="#2e8b57" stroke-width="1" />
  <text x="600" y="267" font-family="Arial" font-size="11" text-anchor="middle">Tier 2: Approval Workflow</text>
  
  <rect x="520" y="280" width="160" height="25" rx="3" ry="3" fill="#ffe6e6" stroke="#2e8b57" stroke-width="1" />
  <text x="600" y="297" font-family="Arial" font-size="11" text-anchor="middle">Tier 3: Monitor Only</text>
  
  <rect x="520" y="310" width="160" height="25" rx="3" ry="3" fill="#f0f7f0" stroke="#2e8b57" stroke-width="1" />
  <text x="600" y="327" font-family="Arial" font-size="11" text-anchor="middle">Distribution Tracking</text>
  
  <!-- Effectiveness Engine -->
  <rect x="310" y="340" width="380" height="70" rx="5" ry="5" fill="#ffffff" stroke="#2e8b57" stroke-width="1" />
  <text x="500" y="360" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Effectiveness Measurement Engine</text>
  
  <rect x="320" y="370" width="110" height="25" rx="3" ry="3" fill="#f0f7f0" stroke="#2e8b57" stroke-width="1" />
  <text x="375" y="387" font-family="Arial" font-size="11" text-anchor="middle">Match Tracking</text>
  
  <rect x="440" y="370" width="110" height="25" rx="3" ry="3" fill="#f0f7f0" stroke="#2e8b57" stroke-width="1" />
  <text x="495" y="387" font-family="Arial" font-size="11" text-anchor="middle">Score Adjustment</text>
  
  <rect x="560" y="370" width="110" height="25" rx="3" ry="3" fill="#f0f7f0" stroke="#2e8b57" stroke-width="1" />
  <text x="615" y="387" font-family="Arial" font-size="11" text-anchor="middle">Metrics Generation</text>
  
  <!-- Dashboard -->
  <rect x="310" y="420" width="380" height="90" rx="5" ry="5" fill="#ffffff" stroke="#2e8b57" stroke-width="1" />
  <text x="500" y="440" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Security Dashboards</text>
  
  <rect x="320" y="450" width="110" height="50" rx="3" ry="3" fill="#f0f7f0" stroke="#2e8b57" stroke-width="1" />
  <text x="375" y="475" font-family="Arial" font-size="11" text-anchor="middle">Indicator Metrics</text>
  
  <rect x="440" y="450" width="110" height="50" rx="3" ry="3" fill="#f0f7f0" stroke="#2e8b57" stroke-width="1" />
  <text x="495" y="475" font-family="Arial" font-size="11" text-anchor="middle">System Health</text>
  
  <rect x="560" y="450" width="110" height="50" rx="3" ry="3" fill="#f0f7f0" stroke="#2e8b57" stroke-width="1" />
  <text x="615" y="475" font-family="Arial" font-size="11" text-anchor="middle">Effectiveness Stats</text>
  
  <!-- Distribution Targets -->
  <rect x="770" y="80" width="180" height="360" rx="10" ry="10" fill="#f7f0f7" stroke="#993399" stroke-width="2" />
  <text x="860" y="100" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle">Distribution Targets</text>
  
  <!-- Microsoft -->
  <rect x="790" y="120" width="140" height="80" rx="5" ry="5" fill="#ffffff" stroke="#993399" stroke-width="1" />
  <text x="860" y="140" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Microsoft</text>
  
  <rect x="800" y="150" width="120" height="20" rx="3" ry="3" fill="#f7f0f7" stroke="#993399" stroke-width="1" />
  <text x="860" y="165" font-family="Arial" font-size="10" text-anchor="middle">Defender XDR</text>
  
  <rect x="800" y="175" width="120" height="20" rx="3" ry="3" fill="#f7f0f7" stroke="#993399" stroke-width="1" />
  <text x="860" y="190" font-family="Arial" font-size="10" text-anchor="middle">Sentinel</text>
  
  <!-- AWS -->
  <rect x="790" y="210" width="140" height="60" rx="5" ry="5" fill="#ffffff" stroke="#993399" stroke-width="1" />
  <text x="860" y="230" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">AWS</text>
  
  <rect x="800" y="240" width="120" height="20" rx="3" ry="3" fill="#f7f0f7" stroke="#993399" stroke-width="1" />
  <text x="860" y="255" font-family="Arial" font-size="10" text-anchor="middle">Security Hub</text>
  
  <!-- GCP -->
  <rect x="790" y="280" width="140" height="60" rx="5" ry="5" fill="#ffffff" stroke="#993399" stroke-width="1" />
  <text x="860" y="300" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">GCP</text>
  
  <rect x="800" y="310" width="120" height="20" rx="3" ry="3" fill="#f7f0f7" stroke="#993399" stroke-width="1" />
  <text x="860" y="325" font-family="Arial" font-size="10" text-anchor="middle">Security Command Center</text>
  
  <!-- Network -->
  <rect x="790" y="350" width="140" height="60" rx="5" ry="5" fill="#ffffff" stroke="#993399" stroke-width="1" />
  <text x="860" y="370" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Network</text>
  
  <rect x="800" y="380" width="55" height="20" rx="3" ry="3" fill="#f7f0f7" stroke="#993399" stroke-width="1" />
  <text x="827" y="395" font-family="Arial" font-size="10" text-anchor="middle">Cisco</text>
  
  <rect x="865" y="380" width="55" height="20" rx="3" ry="3" fill="#f7f0f7" stroke="#993399" stroke-width="1" />
  <text x="892" y="395" font-family="Arial" font-size="10" text-anchor="middle">Palo Alto</text>
  
  <!-- Endpoints -->
  <rect x="790" y="420" width="140" height="60" rx="5" ry="5" fill="#ffffff" stroke="#993399" stroke-width="1" />
  <text x="860" y="440" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">Endpoints</text>
  
  <rect x="800" y="450" width="120" height="20" rx="3" ry="3" fill="#f7f0f7" stroke="#993399" stroke-width="1" />
  <text x="860" y="465" font-family="Arial" font-size="10" text-anchor="middle">CrowdStrike, Carbon Black</text>
  
  <!-- Arrows -->
  <!-- Data Sources to Unified Store -->
  <path d="M230,160 L290,160" fill="none" stroke="#666666" stroke-width="2" />
  <polygon points="288,156 298,160 288,164" fill="#666666" />
  
  <!-- Unified Store to Risk Assessment -->
  <path d="M400,180 L400,190" fill="none" stroke="#666666" stroke-width="2" />
  <polygon points="396,188 400,198 404,188" fill="#666666" />
  
  <!-- Risk Assessment to Inoculation Engine -->
  <path d="M490,260 L510,260" fill="none" stroke="#666666" stroke-width="2" />
  <polygon points="508,256 518,260 508,264" fill="#666666" />
  
  <!-- Inoculation Engine to Distribution Targets -->
  <path d="M690,260 L770,260" fill="none" stroke="#666666" stroke-width="2" />
  <polygon points="768,256 778,260 768,264" fill="#666666" />
  
  <!-- Inoculation Engine to Effectiveness Engine -->
  <path d="M600,330 L600,340" fill="none" stroke="#666666" stroke-width="2" />
  <polygon points="596,338 600,348 604,338" fill="#666666" />
  
  <!-- Effectiveness Engine to Unified Store (feedback loop) -->
  <path d="M310,375 L280,375 L280,150 L310,150" fill="none" stroke="#666666" stroke-width="2" stroke-dasharray="5,3" />
  <polygon points="308,146 318,150 308,154" fill="#666666" />
  
  <!-- Distribution Targets to Effectiveness Engine (telemetry) -->
  <path d="M770,380 L740,380 L740,375 L690,375" fill="none" stroke="#666666" stroke-width="2" stroke-dasharray="5,3" />
  <polygon points="692,371 682,375 692,379" fill="#666666" />
  
  <!-- Legend -->
  <rect x="50" y="520" width="900" height="60" rx="5" ry="5" fill="#f9f9f9" stroke="#999999" stroke-width="1" />
  <text x="70" y="540" font-family="Arial" font-size="14" font-weight="bold">Legend:</text>
  
  <!-- Legend Items -->
  <rect x="70" y="550" width="15" height="15" fill="#e6f2ff" stroke="#0066cc" stroke-width="1" />
  <text x="95" y="562" font-family="Arial" font-size="12">Data Sources</text>
  
  <rect x="200" y="550" width="15" height="15" fill="#f0f7f0" stroke="#2e8b57" stroke-width="1" />
  <text x="225" y="562" font-family="Arial" font-size="12">Core System</text>
  
  <rect x="330" y="550" width="15" height="15" fill="#f7f0f7" stroke="#993399" stroke-width="1" />
  <text x="355" y="562" font-family="Arial" font-size="12">Distribution Targets</text>
  
  <line x1="460" y1="557" x2="490" y2="557" stroke="#666666" stroke-width="2" />
  <polygon points="488,553 498,557 488,561" fill="#666666" />
  <text x="505" y="562" font-family="Arial" font-size="12">Data Flow</text>
  
  <line x1="600" y1="557" x2="630" y2="557" stroke="#666666" stroke-width="2" stroke-dasharray="5,3" />
  <polygon points="628,553 638,557 628,561" fill="#666666" />
  <text x="645" y="562" font-family="Arial" font-size="12">Feedback/Telemetry</text>
  
  <rect x="750" y="550" width="15" height="15" fill="#e6ffe6" stroke="#2e8b57" stroke-width="1" />
  <text x="775" y="562" font-family="Arial" font-size="12">Tier 1 (Auto)</text>
  
  <rect x="850" y="550" width="15" height="15" fill="#ffffe6" stroke="#2e8b57" stroke-width="1" />
  <text x="875" y="562" font-family="Arial" font-size="12">Tier 2 (Approval)</text>
</svg>